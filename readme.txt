

Структура архива:

Dockerfile - файл со структурой образа

psql.sh - используется для запуска службы postgres (по умолчанию изменять не требуется)

requirements.txt - список библиотек для python3, может дополняться - одна библиотека на одну строку 

supervisord.conf - список запусков сервисов внутри контейнера (по умолчанию изменять не требуется)

file.sql (опционально) - содержит структуру базы данных


Сначала создается образ, на базе образа создаются контейнеры


Компиляция образа:
docker build -t <IMAGE-NAME> .

Запуск контейнера:
docker run -d -p 8881:22 -p 8882:5432 -p 8883:8000 --name <CONTAINER-NAME> <IMAGE-NAME>

ОС:контейнер
8881:22 - проброс порта на SSH
8882:5432 - проброс порта на postgres
8883:8000 проброс порта на fastapi

Остановить контейнер:
docker kill <CONTAINER-NAME>

Удалить конейтнер:
docker rm <CONTAINER-NAME>

Удалить образ:
docker rmi <IMAGE-NAME>

Посмотреть все образы:
docker images

Посмотреть все контейнеры:
docker ps -a

Если контейнер не запустился, то необходимо запустить контейнер второй раз но в интерактивном режиме и посмотреть ошибку:
docker run -it -p 8881:22 -p 8882:5432 -p 8883:8000 --name <CONTAINER-NAME> <IMAGE-NAME>

-it открывает терминал внутри самого контейнера, там будет показана ошибка запуска
-d запускает контейнер в режиме демона, рекомендуется использовать если контейнер 100% запустится

приложения с FastAPI нужно запускать с флагами --host 0.0.0.0 --port 8000
